@model VConnect.Models.Cases.CaseIndexVM

@{
    ViewData["Title"] = "Case Studies - VConnect";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center text-white">
        <h1 class="hero-title">Case Studies</h1>
        <p class="hero-subtitle">Exploring our impact through real stories of change and transformation</p>
    </div>
</section>

<!-- Impact Stats -->
<section class="stats-section bg-light">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-3 col-6 mb-4">
                <div class="stat-card">
                    <h2 class="stat-number" id="stat1">0</h2>
                    <p class="stat-label">Successful Projects</p>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stat-card">
                    <h2 class="stat-number" id="stat2">0</h2>
                    <p class="stat-label">Communities Impacted</p>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stat-card">
                    <h2 class="stat-number" id="stat3">0</h2>
                    <p class="stat-label">Volunteers Involved</p>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-4">
                <div class="stat-card">
                    <h2 class="stat-number" id="stat4">0</h2>
                    <p class="stat-label">Success Rate</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Case Study -->
<section class="featured-section">
    <div class="container">
        @if (Model.FeaturedCase != null)
        {
            <div class="text-center section-heading">
                <span class="badge featured-badge">Featured Case Study</span>
                <h2 class="section-title">@Model.FeaturedCase.Title</h2>
                <p class="section-subtitle">@Model.FeaturedCase.Subtitle</p>
            </div>

            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="featured-image-container">
                        <img src="@Model.FeaturedCase.ImageUrl" alt="@Model.FeaturedCase.Title" class="img-fluid rounded-3 shadow">
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="case-meta mb-4">
                        <span class="badge category-badge me-2">@Model.FeaturedCase.Category</span>
                        @if (!string.IsNullOrWhiteSpace(Model.FeaturedCase.Location))
                        {
                            <span class="badge location-badge me-2">@Model.FeaturedCase.Location</span>
                        }
                        @if (!string.IsNullOrWhiteSpace(Model.FeaturedCase.Status))
                        {
                            <span class="badge status-badge">@Model.FeaturedCase.Status</span>
                        }
                    </div>

                    @if (!string.IsNullOrWhiteSpace(Model.FeaturedCase.ShortDescription))
                    {
                        <p class="featured-description mb-4">@Model.FeaturedCase.ShortDescription</p>
                    }

                    <div class="case-stats row text-center mb-4">
                        <div class="col-4">
                            <h4 class="stat-value mb-1">@Model.FeaturedCase.Volunteers</h4>
                            <small>Volunteers</small>
                        </div>
                        <div class="col-4">
                            <h4 class="stat-value mb-1">@Model.FeaturedCase.Beneficiaries.ToString("N0")</h4>
                            <small>Beneficiaries</small>
                        </div>
                        <div class="col-4">
                            <h4 class="stat-value mb-1">@Model.FeaturedCase.Duration</h4>
                            <small>Duration</small>
                        </div>
                    </div>

                    <a href="@Url.Action("Details", "Case", new { id = Model.FeaturedCase.Id })" class="btn btn-warning btn-lg cta-button">
                        <i class="fas fa-book-open me-2"></i>Read Full Case Study
                    </a>
                </div>
            </div>
        }
    </div>
</section>

<!-- Categories Filter -->
<section class="categories-section bg-light">
    <div class="container">
        <div class="text-center section-heading">
            <h2 class="section-title">Explore Our Work</h2>
            <p class="section-subtitle">Browse case studies by category</p>
        </div>

        <div class="row justify-content-center mb-5">
            <div class="col-lg-10">
                <div class="categories-filter d-flex flex-wrap justify-content-center gap-2">
                    <button class="btn filter-btn active" data-filter="all">
                        All <span class="badge count-badge ms-2">@Model.AllCases.Count</span>
                    </button>
                    @foreach (var category in Model.Categories.Where(c => c.Name != "All"))
                    {
                        <button class="btn filter-btn" data-filter="@category.Name.ToLower()">
                            @if (!string.IsNullOrEmpty(category.Icon))
                            {
                                <i class="@category.Icon me-2"></i>
                            }
                            @category.Name <span class="badge count-badge ms-2">@category.Count</span>
                        </button>
                    }
                </div>
            </div>
        </div>

        <!-- All Case Studies Grid -->
        <div class="row g-4" id="caseStudiesGrid">
            @foreach (var caseStudy in Model.AllCases)
            {
                <div class="col-lg-4 col-md-6 case-item" data-category="@caseStudy.Category?.ToLower()">
                    <div class="case-card card border-0 shadow-sm h-100">
                        <div class="case-image-container">
                            <img src="@caseStudy.ImageUrl" class="case-image" alt="@caseStudy.Title">
                            <div class="case-overlay">
                                <span class="badge category-badge">@caseStudy.Category</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="case-meta mb-2">
                                @if (!string.IsNullOrWhiteSpace(caseStudy.Location))
                                {
                                    <small class="text-muted">
                                        <i class="fas fa-map-marker-alt me-1"></i>@caseStudy.Location
                                    </small>
                                }
                                @if (!string.IsNullOrWhiteSpace(caseStudy.Status))
                                {
                                    <span class="badge @(caseStudy.Status == "Completed" ? "status-badge" : "bg-warning") float-end">@caseStudy.Status</span>
                                }
                            </div>

                            <h5 class="card-title case-title">@caseStudy.Title</h5>
                            @if (!string.IsNullOrWhiteSpace(caseStudy.ShortDescription))
                            {
                                <p class="card-text case-description">@caseStudy.ShortDescription</p>
                            }

                            <div class="case-stats d-flex justify-content-between mb-3">
                                <small><i class="fas fa-users me-1"></i>@caseStudy.Volunteers volunteers</small>
                                <small><i class="fas fa-user-check me-1"></i>@caseStudy.Beneficiaries.ToString("N0") reached</small>
                            </div>
                        </div>
                        <div class="card-footer bg-transparent border-0">
                            <a href="@Url.Action("Details", "Case", new { id = caseStudy.Id })" class="btn btn-sm w-100 case-button">
                                Read Case Study
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>

        <!-- No Results -->
        <div id="noResults" class="text-center mt-5" style="display:none;">
            <div class="py-5">
                <i class="fas fa-search fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No case studies found</h4>
                <p class="text-muted">Try selecting a different category</p>
            </div>
        </div>
    </div>
</section>

<!-- CTA -->
<section class="cta-section">
    <div class="container text-center text-white">
        <h2 class="cta-title mb-3">Inspired by Our Work?</h2>
        <p class="cta-subtitle mb-4">Join us in creating more success stories across Bangladesh</p>
        <div class="d-flex gap-3 justify-content-center cta-buttons">
            <a href="@Url.Action("Register", "Account")" class="btn btn-warning btn-lg px-4">
                <i class="fas fa-user-plus me-2"></i>Join as Volunteer
            </a>
            <a href="Donation/Create" class="btn btn-outline-light btn-lg px-4">
                <i class="fas fa-donate me-2"></i>Support Our Projects
            </a>
        </div>
    </div>
</section>

@section Styles {
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0b3d2e;
            --secondary-color: #1a5e48;
            --accent-color: #ffc107;
            --dark-text: #232a36;
        }

        .hero-section {
            padding: 7rem 0 5rem;
            background: linear-gradient(135deg,var(--dark-text)0%,var(--secondary-color)100%);
            margin-top: -25px
        }

        .hero-title {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 1rem
        }

        .hero-subtitle {
            font-size: 1.35rem;
            max-width: 700px;
            margin: 0 auto
        }

        .stats-section {
            padding: 5rem 0
        }

        .stat-card {
            padding: 2rem 1rem;
            transition: transform .3s
        }

            .stat-card:hover {
                transform: translateY(-5px)
            }

        .stat-number {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--primary-color)
        }

        .section-heading {
            margin-bottom: 4rem
        }

        .featured-badge {
            background: var(--accent-color);
            color: #000;
            padding: .5rem 1rem;
            margin-bottom: 1.5rem
        }

        .section-title {
            color: var(--primary-color);
            font-weight: 700
        }

        .featured-section, .categories-section {
            padding: 5rem 0
        }

        .featured-image-container {
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 15px 30px rgba(0,0,0,.1)
        }

            .featured-image-container img {
                transition: transform .5s
            }

            .featured-image-container:hover img {
                transform: scale(1.03)
            }

        .category-badge {
            background: var(--primary-color);
            color: #fff
        }

        .location-badge {
            background: #6c757d;
            color: #fff
        }

        .status-badge {
            background: #198754;
            color: #fff
        }

        .count-badge {
            background: #fff;
            color: var(--primary-color)
        }

        .case-card {
            transition: transform .3s,box-shadow .3s;
            border-radius: 15px;
            overflow: hidden
        }

            .case-card:hover {
                transform: translateY(-8px);
                box-shadow: 0 15px 35px rgba(0,0,0,.1) !important
            }

        .case-image-container {
            position: relative;
            height: 220px;
            overflow: hidden
        }

        .case-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform .5s
        }

        .case-card:hover .case-image {
            transform: scale(1.1)
        }

        .case-overlay {
            position: absolute;
            top: 15px;
            left: 15px
        }

        .case-title {
            color: var(--primary-color);
            font-weight: 700
        }

        .case-description {
            color: #6c757d
        }

        .case-button {
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 50px
        }

        .cta-section {
            padding: 5rem 0;
            background: linear-gradient(135deg,var(--primary-color)0%,var(--secondary-color)100%)
        }
        @@media(max - width:992px) {
            .hero-title

        {
            font-size: 2.5rem
        }

        }
        @@media(max - width:768px) {
            .hero-title

        {
            font-size: 2.2rem
        }

        }
    </style>
}

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded',function(){
          // Counters
          function bump(el,target,isPct){let cur=0,inc=Math.max(1,Math.floor(target/50));let t=setInterval(()=>{cur+=inc;if(cur>=target){cur=target;clearInterval(t)}el.textContent=isPct?cur+'%':cur.toLocaleString();},40);}
          bump(document.getElementById('stat1'), @Model.ImpactStats?.TotalCases ?? 0, false);
          bump(document.getElementById('stat2'), @Model.ImpactStats?.CommunitiesImpacted ?? 0, false);
          bump(document.getElementById('stat3'), @Model.ImpactStats?.VolunteersInvolved ?? 0, false);
          bump(document.getElementById('stat4'), @Model.ImpactStats?.SuccessRate ?? 0, true);

          // Filtering
          const btns=document.querySelectorAll('.filter-btn');
          const items=document.querySelectorAll('.case-item');
          const none=document.getElementById('noResults');
          const grid=document.getElementById('caseStudiesGrid');

          function filter(cat){
            let visible=0;
            items.forEach(it=>{
              const c=(it.getAttribute('data-category')||'').toLowerCase();
              const match = cat==='all'||c===cat;
              it.style.display = match?'block':'none';
              if(match) visible++;
            });
            none.style.display = visible? 'none':'block';
            grid.style.display = visible? 'flex':'none';
          }

          btns.forEach(b=>b.addEventListener('click',function(){
            btns.forEach(x=>x.classList.remove('active'));
            this.classList.add('active');
            filter(this.getAttribute('data-filter'));
          }));
          filter('all');
        });
    </script>
}
